<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Routt Distillery crafts unique, small-batch whiskey, gin, and vodka in Steamboat Springs, Colorado, using local grains. Visit our family-owned tasting room!">
    <meta name="keywords" content="Routt Distillery, Steamboat Springs, Colorado spirits, small-batch whiskey, gin, vodka, family-owned distillery">
    <meta name="author" content="Routt Distillery">
    <title>Find Us - Routt Distillery</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="images/routt-logo.png" type="image/png">
    <style>
        .section {
            display: flex;
            align-items: center;
            margin-bottom: 60px;
            gap: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
        }
        .section:hover {
            background-color: rgba(248, 248, 248, 1);
        }
        .section img {
            width: 300px;
            height: 300px;
            object-fit: cover;
            border-radius: 5px;
        }
        .section .text {
            width: 50%;
        }
        .section.reverse {
            flex-direction: row-reverse;
        }
        #findus.section {
            justify-content: center;
            text-align: center;
        }
        #findus .text {
            width: 100%;
        }
        #findus .text p {
            margin: 10px 0;
            font-size: 1.1em;
        }
        #findus .text .highlight {
            font-weight: bold;
            font-size: 1.2em;
            color: #000;
        }
        #findus .text .details {
            margin-top: 15px;
            font-style: italic;
            color: #555;
        }
        #findus .text .phone-link {
            color: #333;
            text-decoration: none;
        }
        #findus .text .phone-link:hover {
            color: #666;
        }
        #map-section.section {
            height: 500px;
            padding: 0;
            background-color: transparent;
        }
        gmpx-store-locator {
            width: 100%;
            height: 100%;
            border-radius: 15px;
            --gmpx-color-surface: rgba(255, 255, 255, 0.9);
            --gmpx-color-on-surface: #333;
            --gmpx-color-on-surface-variant: #757575;
            --gmpx-color-primary: #1967d2;
            --gmpx-color-outline: #e0e0e0;
            --gmpx-fixed-panel-width-row-layout: 28.5em;
            --gmpx-fixed-panel-height-column-layout: 65%;
            --gmpx-font-family-base: "Avenir", "Segoe UI", "Helvetica", "Arial", sans-serif;
            --gmpx-font-family-headings: "Avenir", "Segoe UI", "Helvetica", "Arial", sans-serif;
            --gmpx-font-size-base: 1rem;
            --gmpx-hours-color-open: #188038;
            --gmpx-hours-color-closed: #d50000;
            --gmpx-rating-color: #ffb300;
            --gmpx-rating-color-empty: #e0e0e0;
        }
        @media (prefers-color-scheme: dark) {
            .section {
                background-color: rgba(47, 47, 47, 0.9);
                padding: 20px;
                border-radius: 15px;
            }
            .section:hover {
                background-color: rgba(47, 47, 47, 1);
            }
            #map-section.section {
                background-color: transparent;
            }
            gmpx-store-locator {
                --gmpx-color-surface: rgba(47, 47, 47, 0.9);
                --gmpx-color-on-surface: #e0e0e0;
                --gmpx-color-on-surface-variant: #bbb;
            }
            #findus .text .highlight {
                color: #fff;
            }
            #findus .text .details {
                color: #bbb;
            }
            #findus .text .phone-link {
                color: #e0e0e0;
            }
            #findus .text .phone-link:hover {
                color: #bbb;
            }
        }
        @media (max-width: 768px) {
            .section, .section.reverse {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            .section img {
                width: 100%;
                max-width: 300px;
                height: auto;
            }
            .section .text {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <nav>
        <a href="index.html"><img src="images/routt-logo.png" alt="Routt Distillery Logo" class="nav-logo"></a>
        <a href="spirits.html">Spirits</a>
        <a href="cocktails.html">Cocktails</a>
        <a href="about.html">About Us</a>
        <a href="findus.html">Find Us</a>
    </nav>

    <div class="container">
        <h1>Find Us</h1>
        <section id="findus" class="section">
            <div class="text">
                <h2>Visit Us at Routt Distillery</h2>
                <p>Nestled just a stone’s throw from downtown Steamboat Springs, our distillery at <a href="https://www.google.com/maps/place/Routt+Distillery" target="_blank">975 Captain Jack Drive</a> is the perfect spot to experience handcrafted spirits in a stunning setting. We’re only a <span class="highlight">2-minute drive</span>, a <span class="highlight">5-minute bike ride</span>, or a leisurely <span class="highlight">15-minute walk</span> from the heart of downtown.</p>
                <p>Our tasting room welcomes you on <span class="highlight">Fridays and Saturdays from 1 PM to 6 PM</span>, offering tours, tastings, and expertly crafted cocktails. Enjoy breathtaking views, bring your furry friends (we’re dog-friendly!), and feel free to pack your own food to make a day of it.</p>
                <p class="details">Whether you’re a local or just passing through, we can’t wait to share our passion for spirits with you! If you have any questions, feel free to give us a call or text at <a href="tel:9703677477" class="phone-link highlight" aria-label="Call Routt Distillery at 970-367-7477">970-367-7477</a>.</p>
                <p>
                    <span class="social-icons">
                        <a href="https://x.com/routtdistillery" target="_blank" rel="noopener noreferrer" aria-label="Follow us on X"><i class="fa-brands fa-x-twitter"></i></a>
                        <a href="https://instagram.com/routtdistillery" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://facebook.com/routtdistillery" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="mailto:info@routtdistillery.com" aria-label="Email us"><i class="fas fa-envelope"></i></a>
                    </span>
                </p>
            </div>
        </section>

        <section id="map-section" class="section">
            <gmpx-api-loader key="AIzaSyAY1Bo24VbMJ-Sw3ab7bBRnudBZ5RNBOG8" solution-channel="GMP_QB_locatorplus_v11_c"></gmpx-api-loader>
            <gmpx-store-locator map-id="DEMO_MAP_ID" aria-label="Map showing Routt Distillery and nearby locations"></gmpx-store-locator>
        </section>
    </div>

    <footer>
        <p>© 2025 Routt Distillery. All rights reserved. | <a href="cookie-policy.html">Cookie Policy</a></p>
        <p>
            <span class="social-icons">
                <a href="https://x.com/routtdistillery" target="_blank" rel="noopener noreferrer" aria-label="Follow us on X"><i class="fa-brands fa-x-twitter"></i></a>
                <a href="https://instagram.com/routtdistillery" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://facebook.com/routtdistillery" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Facebook"><i class="fab fa-facebook"></i></a>
                <a href="mailto:info@routtdistillery.com" aria-label="Email us"><i class="fas fa-envelope"></i></a>
                <a href="https://www.google.com/maps/place/Routt+Distillery" target="_blank" rel="noopener noreferrer" aria-label="Visit us on Google Maps"><i class="fab fa-google"></i></a>
            </span>
        </p>
    </footer>

    <script>
        async function fetchLocations() {
            try {
                const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vTjGIUuPQAzwCsBOGgfpFy17Y4Gyl_mU6gyqc9-Ms5rBbeomzUGlA6q0ytP6ZYWvBuX8ylbAfu99att/pub?output=csv');
                const csvText = await response.text();
                const rows = csvText.split('\n').slice(1); // Skip header row
                const locations = [];

                for (const row of rows) {
                    let currentField = '';
                    let inQuotes = false;
                    const fields = [];

                    for (let i = 0; i < row.length; i++) {
                        const char = row[i];
                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            fields.push(currentField);
                            currentField = '';
                        } else {
                            currentField += char;
                        }
                    }
                    if (currentField) fields.push(currentField); // Add last field

                    if (fields.length === 6) {
                        const [title, address1, address2, lat, lng, placeId] = fields.map(f => f.trim());
                        const latNum = parseFloat(lat);
                        const lngNum = parseFloat(lng);
                        if (title && !isNaN(latNum) && !isNaN(lngNum)) {
                            locations.push({
                                title,
                                address1,
                                address2,
                                coords: { lat: latNum, lng: lngNum },
                                placeId
                            });
                        }
                    }
                }

                console.log('Fetched locations:', locations); // Debug log
                return locations;
            } catch (error) {
                console.error('Error fetching locations:', error);
                return [];
            }
        }

        const CONFIGURATION = {
            mapOptions: {
                "center": { "lat": 40.484982, "lng": -106.831716 },
                "fullscreenControl": true,
                "mapTypeControl": false,
                "streetViewControl": false,
                "zoom": 12,
                "zoomControl": true,
                "maxZoom": 17,
                "styles": [
                    { "featureType": "all", "elementType": "all", "stylers": [{ "saturation": -50 }, { "lightness": 20 }] },
                    { "featureType": "water", "elementType": "all", "stylers": [{ "color": "#d4e4eb" }] },
                    { "featureType": "landscape", "elementType": "all", "stylers": [{ "color": "#f5f5f5" }] },
                    { "featureType": "road", "elementType": "geometry", "stylers": [{ "color": "#e0d7c6" }] },
                    { "featureType": "poi", "elementType": "all", "stylers": [{ "lightness": 30 }] },
                    { "featureType": "administrative", "elementType": "labels", "stylers": [{ "color": "#666666" }] }
                ]
            },
            "mapsApiKey": "AIzaSyAY1Bo24VbMJ-Sw3ab7bBRnudBZ5RNBOG8",
            "capabilities": {
                "input": true,
                "autocomplete": true,
                "directions": true,
                "distanceMatrix": true,
                "details": true,
                "actions": true
            }
        };

        document.addEventListener('DOMContentLoaded', async () => {
            await customElements.whenDefined('gmpx-store-locator');
            const locator = document.querySelector('gmpx-store-locator');
            
            CONFIGURATION.locations = await fetchLocations();
            locator.configureFromQuickBuilder(CONFIGURATION);

            // Commented out to avoid "Map object not initialized" error
            /*
            const map = locator.map;
            if (map) {
                map.addListener('idle', () => {
                    const markers = locator.querySelectorAll('gmp-marker');
                    markers.forEach(marker => {
                        const position = marker.position;
                        if (position.lat === 40.49035295668196 && position.lng === -106.85310157724608) {
                            marker.icon = { url: "http://maps.google.com/mapfiles/ms/icons/red-dot.png" };
                        }
                        marker.addEventListener('click', () => {
                            map.setCenter(position);
                            map.setZoom(15);
                        });
                    });
                });
            } else {
                console.error('Map object not initialized');
            }
            */
        });
    </script>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/@googlemaps/extended-component-library/0.6.11/index.min.js"></script>
</body>
</html>